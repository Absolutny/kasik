<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–ª–æ—Ç—ã - Casino</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        /* –ê–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è —Å–ª–æ—Ç–æ–≤ */
        @keyframes reelSpin {
            0% { transform: translateY(0); opacity: 0.5; }
            50% { transform: translateY(-20px); opacity: 0.8; }
            100% { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes winGlow {
            0%, 100% { 
                box-shadow: 0 0 5px #4CAF50, 0 0 10px #4CAF50 inset;
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 0 20px #4CAF50, 0 0 30px #4CAF50 inset;
                transform: scale(1.05);
            }
        }
        
        @keyframes loseShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .reel.spinning {
            animation: reelSpin 0.3s ease-in-out 3;
        }
        
        .reel.win {
            animation: winGlow 0.5s ease-in-out 3;
        }
        
        .result.lose {
            animation: loseShake 0.3s ease-in-out;
        }
        
        .spin-btn:active {
            transform: scale(0.95);
            transition: transform 0.1s;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ –ò–≥—Ä–æ–≤—ã–µ –∞–≤—Ç–æ–º–∞—Ç—ã</h1>
            <div class="balance">–ë–∞–ª–∞–Ω—Å: <span id="balance">{{ balance }}</span> –∫–æ–ø–µ–π–∫–∞</div>
        </div>

        <div class="games-navigation">
            <a href="/" class="nav-btn">üè† –ì–ª–∞–≤–Ω–∞—è</a>
            <a href="/blackjack" class="nav-btn">‚ô†Ô∏è –ë–ª—ç–∫–¥–∂–µ–∫</a>
            <a href="/coinflip" class="nav-btn">ü™ô –ú–æ–Ω–µ—Ç–∫–∞</a>
            <a href="/dice" class="nav-btn">üé≤ –ö–æ—Å—Ç–∏</a>
        </div>

        <div class="slots-machine">
            <div class="reels">
                <div class="reel" id="reel1">{{ reels[0] }}</div>
                <div class="reel" id="reel2">{{ reels[1] }}</div>
                <div class="reel" id="reel3">{{ reels[2] }}</div>
            </div>

            <form method="POST" class="controls" id="slotsForm">
                <select name="bet">
                    <option value="10">10 –∫–æ–ø–µ–π–∫–∞</option>
                    <option value="25">25 –∫–æ–ø–µ–π–∫–∞</option>
                    <option value="50">50 –∫–æ–ø–µ–π–∫–∞</option>
                    <option value="100">100 –∫–æ–ø–µ–π–∫–∞</option>
                    <option value="500">500 –∫–æ–ø–µ–π–∫–∞</option>
                    <option value="1000">1000 –∫–æ–ø–µ–π–∫–∞</option>
                </select>
                <button type="submit" class="spin-btn" id="spinBtn">üé∞ –ö—Ä—É—Ç–∏—Ç—å!</button>
            </form>

            {% if message %}
            <div class="result {% if '–≤—ã–∏–≥—Ä–∞–ª–∏' in message %}win{% else %}lose{% endif %}" id="resultMessage">
                {{ message }}
            </div>
            {% endif %}
        </div>

        <div class="game-rules">
            <h3>üìñ –ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã:</h3>
            <ul>
                <li>3 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–∞ = x5 –≤—ã–∏–≥—Ä—ã—à (x10 –¥–ª—è üíé)</li>
                <li>2 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–∞ = x2 –≤—ã–∏–≥—Ä—ã—à</li>
                <li>–†–∞–∑–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã = –ø—Ä–æ–∏–≥—Ä—ã—à</li>
            </ul>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const spinBtn = document.getElementById('spinBtn');
            const resultMessage = document.getElementById('resultMessage');
            const reels = document.querySelectorAll('.reel');
            const balanceSpan = document.getElementById('balance');
            
            // –ï—Å–ª–∏ –µ—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ, –∑–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
if (resultMessage) {
                if (resultMessage.classList.contains('win')) {
                    // –ê–Ω–∏–º–∞—Ü–∏—è –≤—ã–∏–≥—Ä—ã—à–∞
                    setTimeout(() => {
                        reels.forEach(reel => {
                            reel.classList.add('win');
                            setTimeout(() => {
                                reel.classList.remove('win');
                            }, 1500);
                        });
                    }, 300);
                } else {
                    // –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–æ–∏–≥—Ä—ã—à–∞
                    resultMessage.classList.add('lose');
                    setTimeout(() => {
                        resultMessage.classList.remove('lose');
                    }, 1000);
                }
            }
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∫–Ω–æ–ø–∫—É
            if (spinBtn) {
                spinBtn.addEventListener('click', function(e) {
                    if (!document.getElementById('slotsForm').checkValidity()) {
                        return;
                    }
                    
                    // –ê–Ω–∏–º–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = 'scale(1)';
                    }, 100);
                    
                    // –ê–Ω–∏–º–∞—Ü–∏—è –±–∞—Ä–∞–±–∞–Ω–æ–≤
                    reels.forEach((reel, index) => {
                        setTimeout(() => {
                            reel.classList.add('spinning');
                            setTimeout(() => {
                                reel.classList.remove('spinning');
                            }, 900);
                        }, index * 100);
                    });
                });
            }
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –±–∞–ª–∞–Ω—Å–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
            if (balanceSpan) {
                const observer = new MutationObserver(function(mutations) {
                    mutations.forEach(function(mutation) {
                        if (mutation.type === 'characterData' || mutation.type === 'childList') {
                            balanceSpan.style.animation = 'none';
                            setTimeout(() => {
                                balanceSpan.style.animation = 'winGlow 0.5s ease';
                            }, 10);
                        }
                    });
                });
                
                observer.observe(balanceSpan, {
                    characterData: true,
                    childList: true,
                    subtree: true
                });
            }
        });
    </script>
</body>
</html>
